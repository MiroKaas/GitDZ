[student1669_3@bigdataanalytics-worker-3 ~]$ pyspark --packages org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.2
SPARK_MAJOR_VERSION is set to 2, using Spark2
Python 2.7.5 (default, Nov 16 2020, 22:23:17) 
[GCC 4.8.5 20150623 (Red Hat 4.8.5-44)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
Ivy Default Cache set to: /home/student1669_3/.ivy2/cache
The jars for the packages stored in: /home/student1669_3/.ivy2/jars
:: loading settings :: url = jar:file:/usr/hdp/3.1.4.0-315/spark2/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
org.apache.spark#spark-sql-kafka-0-10_2.11 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-995399ed-fa50-4ee3-b80d-114298334cd0;1.0
	confs: [default]
	found org.apache.spark#spark-sql-kafka-0-10_2.11;2.3.2 in central
	found org.apache.kafka#kafka-clients;0.10.0.1 in central
	found net.jpountz.lz4#lz4;1.3.0 in central
	found org.xerial.snappy#snappy-java;1.1.2.6 in central
	found org.slf4j#slf4j-api;1.7.16 in central
	found org.spark-project.spark#unused;1.0.0 in central
downloading https://repo1.maven.org/maven2/org/apache/spark/spark-sql-kafka-0-10_2.11/2.3.2/spark-sql-kafka-0-10_2.11-2.3.2.jar ...
	[SUCCESSFUL ] org.apache.spark#spark-sql-kafka-0-10_2.11;2.3.2!spark-sql-kafka-0-10_2.11.jar (104ms)
downloading https://repo1.maven.org/maven2/org/apache/kafka/kafka-clients/0.10.0.1/kafka-clients-0.10.0.1.jar ...
	[SUCCESSFUL ] org.apache.kafka#kafka-clients;0.10.0.1!kafka-clients.jar (75ms)
downloading https://repo1.maven.org/maven2/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar ...
	[SUCCESSFUL ] org.spark-project.spark#unused;1.0.0!unused.jar (35ms)
downloading https://repo1.maven.org/maven2/net/jpountz/lz4/lz4/1.3.0/lz4-1.3.0.jar ...
	[SUCCESSFUL ] net.jpountz.lz4#lz4;1.3.0!lz4.jar (46ms)
downloading https://repo1.maven.org/maven2/org/xerial/snappy/snappy-java/1.1.2.6/snappy-java-1.1.2.6.jar ...
	[SUCCESSFUL ] org.xerial.snappy#snappy-java;1.1.2.6!snappy-java.jar(bundle) (71ms)
downloading https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.16/slf4j-api-1.7.16.jar ...
	[SUCCESSFUL ] org.slf4j#slf4j-api;1.7.16!slf4j-api.jar (36ms)
:: resolution report :: resolve 3553ms :: artifacts dl 373ms
	:: modules in use:
	net.jpountz.lz4#lz4;1.3.0 from central in [default]
	org.apache.kafka#kafka-clients;0.10.0.1 from central in [default]
	org.apache.spark#spark-sql-kafka-0-10_2.11;2.3.2 from central in [default]
	org.slf4j#slf4j-api;1.7.16 from central in [default]
	org.spark-project.spark#unused;1.0.0 from central in [default]
	org.xerial.snappy#snappy-java;1.1.2.6 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   6   |   6   |   6   |   0   ||   6   |   6   |
	---------------------------------------------------------------------

:: problems summary ::
:::: ERRORS
	Server access error at url http://dl.bintray.com/spark-packages/maven/org/apache/apache/18/apache-18.jar (java.net.SocketException: Unexpected end of file from server)

	Server access error at url http://dl.bintray.com/spark-packages/maven/org/apache/spark/spark-parent_2.11/2.3.2/spark-parent_2.11-2.3.2.jar (java.net.SocketException: Unexpected end of file from server)

	Server access error at url http://dl.bintray.com/spark-packages/maven/org/apache/spark/spark-sql-kafka-0-10_2.11/2.3.2/spark-sql-kafka-0-10_2.11-2.3.2-javadoc.jar (java.net.SocketException: Unexpected end of file from server)

	Server access error at url http://dl.bintray.com/spark-packages/maven/org/slf4j/slf4j-parent/1.7.16/slf4j-parent-1.7.16.jar (java.net.SocketException: Unexpected end of file from server)

	Server access error at url http://dl.bintray.com/spark-packages/maven/org/sonatype/oss/oss-parent/9/oss-parent-9.jar (java.net.SocketException: Unexpected end of file from server)


:: USE VERBOSE OR DEBUG MESSAGE LEVEL FOR MORE DETAILS
:: retrieving :: org.apache.spark#spark-submit-parent-995399ed-fa50-4ee3-b80d-114298334cd0
	confs: [default]
	6 artifacts copied, 0 already retrieved (2441kB/8ms)
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/08/26 12:46:39 WARN Client: Same path resource file:///home/student1669_3/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.11-2.3.2.jar added multiple times to distributed cache.
22/08/26 12:46:39 WARN Client: Same path resource file:///home/student1669_3/.ivy2/jars/org.apache.kafka_kafka-clients-0.10.0.1.jar added multiple times to distributed cache.
22/08/26 12:46:39 WARN Client: Same path resource file:///home/student1669_3/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar added multiple times to distributed cache.
22/08/26 12:46:39 WARN Client: Same path resource file:///home/student1669_3/.ivy2/jars/net.jpountz.lz4_lz4-1.3.0.jar added multiple times to distributed cache.
22/08/26 12:46:39 WARN Client: Same path resource file:///home/student1669_3/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.2.6.jar added multiple times to distributed cache.
22/08/26 12:46:39 WARN Client: Same path resource file:///home/student1669_3/.ivy2/jars/org.slf4j_slf4j-api-1.7.16.jar added multiple times to distributed cache.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /__ / .__/\_,_/_/ /_/\_\   version 2.3.2.3.1.4.0-315
      /_/

Using Python version 2.7.5 (default, Nov 16 2020 22:23:17)
SparkSession available as 'spark'.
>>> fom pyspark.sql import functions as F
  File "<stdin>", line 1
    fom pyspark.sql import functions as F
              ^
SyntaxError: invalid syntax
>>> from pyspark.sql import functions as F
>>> from pyspark.sql.types import StructType, StringType
>>> kafka_brokers = "bigdataanalytics-worker-3:6667"
>>> def console_output(df, freq):
...     return df.writeStream \
...         .format("console") \
...         .trigger(processingTime='%s seconds' % freq ) \
...         .options(truncate=False) \
...         .start()
... 
>>> raw_orders =  spark.read\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "earliest")\
...         .load()
>>> raw_orders.show()
+---+-----+-----+---------+------+---------+-------------+                      
|key|value|topic|partition|offset|timestamp|timestampType|
+---+-----+-----+---------+------+---------+-------------+
+---+-----+-----+---------+------+---------+-------------+

>>> raw_orders.show()
+----+--------------------+------------+---------+------+--------------------+-------------+
| key|               value|       topic|partition|offset|           timestamp|timestampType|
+----+--------------------+------------+---------+------+--------------------+-------------+
|null|[49 64 2C 53 65 7...|shadrin_iris|        0|   608|2022-08-26 13:14:...|            0|
|null|[31 2C 35 2E 31 2...|shadrin_iris|        0|   609|2022-08-26 13:14:...|            0|
|null|[32 2C 34 2E 39 2...|shadrin_iris|        0|   610|2022-08-26 13:14:...|            0|
|null|[33 2C 34 2E 37 2...|shadrin_iris|        0|   611|2022-08-26 13:14:...|            0|
|null|[34 2C 34 2E 36 2...|shadrin_iris|        0|   612|2022-08-26 13:14:...|            0|
|null|[35 2C 35 2E 30 2...|shadrin_iris|        0|   613|2022-08-26 13:14:...|            0|
|null|[36 2C 35 2E 34 2...|shadrin_iris|        0|   614|2022-08-26 13:14:...|            0|
|null|[37 2C 34 2E 36 2...|shadrin_iris|        0|   615|2022-08-26 13:14:...|            0|
|null|[38 2C 35 2E 30 2...|shadrin_iris|        0|   616|2022-08-26 13:14:...|            0|
|null|[39 2C 34 2E 34 2...|shadrin_iris|        0|   617|2022-08-26 13:14:...|            0|
|null|[31 30 2C 34 2E 3...|shadrin_iris|        0|   618|2022-08-26 13:14:...|            0|
|null|[31 31 2C 35 2E 3...|shadrin_iris|        0|   619|2022-08-26 13:14:...|            0|
|null|[31 32 2C 34 2E 3...|shadrin_iris|        0|   620|2022-08-26 13:14:...|            0|
|null|[31 33 2C 34 2E 3...|shadrin_iris|        0|   621|2022-08-26 13:14:...|            0|
|null|[31 34 2C 34 2E 3...|shadrin_iris|        0|   622|2022-08-26 13:14:...|            0|
|null|[31 35 2C 35 2E 3...|shadrin_iris|        0|   623|2022-08-26 13:14:...|            0|
|null|[31 36 2C 35 2E 3...|shadrin_iris|        0|   624|2022-08-26 13:14:...|            0|
|null|[31 37 2C 35 2E 3...|shadrin_iris|        0|   625|2022-08-26 13:14:...|            0|
|null|[31 38 2C 35 2E 3...|shadrin_iris|        0|   626|2022-08-26 13:14:...|            0|
|null|[31 39 2C 35 2E 3...|shadrin_iris|        0|   627|2022-08-26 13:14:...|            0|
+----+--------------------+------------+---------+------+--------------------+-------------+
only showing top 20 rows

>>> raw_orders.printSchema()
root
 |-- key: binary (nullable = true)
 |-- value: binary (nullable = true)
 |-- topic: string (nullable = true)
 |-- partition: integer (nullable = true)
 |-- offset: long (nullable = true)
 |-- timestamp: timestamp (nullable = true)
 |-- timestampType: integer (nullable = true)

>>> raw_orders.show(1,false)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'false' is not defined
>>> raw_orders.show(1,False)
+----+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                                                                                                                            |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[49 64 2C 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 2C 53 65 70 61 6C 57 69 64 74 68 43 6D 2C 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 2C 50 65 74 61 6C 57 69 64 74 68 43 6D 2C 53 70 65 63 69 65 73]|shadrin_iris|0        |608   |2022-08-26 13:14:23.722|0            |
+----+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
only showing top 1 row

>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "earliest")\
...         .load()
>>> out = console_output(raw_orders,5)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-----+-----+---------+------+---------+-------------+
|key|value|topic|partition|offset|timestamp|timestampType|
+---+-----+-----+---------+------+---------+-------------+
+---+-----+-----+---------+------+---------+-------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[7B 22 49 64 22 3A 20 22 49 64 22 2C 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 2C 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 2C 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 2C 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 2C 20 22 53 70 65 63 69 65 73 22 3A 20 22 53 70 65 63 69 65 73 22 7D]|shadrin_iris|0        |759   |2022-08-26 13:29:35.485|0            |
+----+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[5B]                                                                                       |shadrin_iris|0        |760   |2022-08-26 13:30:33.932|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |761   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 31 2C]                                                |shadrin_iris|0        |762   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2E 31 2C]         |shadrin_iris|0        |763   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 35 2C]            |shadrin_iris|0        |764   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]         |shadrin_iris|0        |765   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |766   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |767   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |768   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |769   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 32 2C]                                                |shadrin_iris|0        |770   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 39 2C]         |shadrin_iris|0        |771   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2C]                  |shadrin_iris|0        |772   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]         |shadrin_iris|0        |773   |2022-08-26 13:30:33.938|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |774   |2022-08-26 13:30:33.939|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |775   |2022-08-26 13:30:33.939|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |776   |2022-08-26 13:30:33.939|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |777   |2022-08-26 13:30:33.939|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 33 2C]                                                |shadrin_iris|0        |778   |2022-08-26 13:30:33.939|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 37 2C]         |shadrin_iris|0        |779   |2022-08-26 13:30:33.939|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
only showing top 20 rows

>>> out.stop()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "orders_json")\
...         .option("startingOffests", "earliest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "earliest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> out = console_output(raw_orders,5)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-----+-----+---------+------+---------+-------------+
|key|value|topic|partition|offset|timestamp|timestampType|
+---+-----+-----+---------+------+---------+-------------+
+---+-----+-----+---------+------+---------+-------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[5B]                                                                              |shadrin_iris|0        |1962  |2022-08-26 13:43:52.229|0            |
|null|[20 20 20 20 7B]                                                                  |shadrin_iris|0        |1963  |2022-08-26 13:43:52.234|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 31 2C]                                       |shadrin_iris|0        |1964  |2022-08-26 13:43:52.234|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2E 31 2C]|shadrin_iris|0        |1965  |2022-08-26 13:43:52.234|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 35 2C]   |shadrin_iris|0        |1966  |2022-08-26 13:43:52.234|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]         |shadrin_iris|0        |1967  |2022-08-26 13:43:52.234|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |1968  |2022-08-26 13:43:52.234|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |1969  |2022-08-26 13:43:52.234|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |1970  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |1971  |2022-08-26 13:43:52.235|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 32 2C]                                       |shadrin_iris|0        |1972  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 39 2C]|shadrin_iris|0        |1973  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2C]         |shadrin_iris|0        |1974  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]|shadrin_iris|0        |1975  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]   |shadrin_iris|0        |1976  |2022-08-26 13:43:52.235|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 4
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |1977  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |1978  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |1979  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 33 2C]                                                |shadrin_iris|0        |1980  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 37 2C]         |shadrin_iris|0        |1981  |2022-08-26 13:43:52.235|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 5
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 32 2C]            |shadrin_iris|0        |1982  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 33 2C]         |shadrin_iris|0        |1983  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |1984  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |1985  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |1986  |2022-08-26 13:43:52.235|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 6
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 7B]                                                                  |shadrin_iris|0        |1987  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 34 2C]                                       |shadrin_iris|0        |1988  |2022-08-26 13:43:52.235|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 36 2C]|shadrin_iris|0        |1989  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 31 2C]   |shadrin_iris|0        |1990  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 35 2C]|shadrin_iris|0        |1991  |2022-08-26 13:43:52.236|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 7
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |1992  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |1993  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |1994  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |1995  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 35 2C]                                                |shadrin_iris|0        |1996  |2022-08-26 13:43:52.236|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 8
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2C]               |shadrin_iris|0        |1997  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 36 2C]            |shadrin_iris|0        |1998  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]         |shadrin_iris|0        |1999  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |2000  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |2001  |2022-08-26 13:43:52.236|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 9
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 7D 2C]                                                               |shadrin_iris|0        |2002  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 7B]                                                                  |shadrin_iris|0        |2003  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 36 2C]                                       |shadrin_iris|0        |2004  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2E 34 2C]|shadrin_iris|0        |2005  |2022-08-26 13:43:52.236|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 39 2C]   |shadrin_iris|0        |2006  |2022-08-26 13:43:52.236|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

out.stop()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "latest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> out = console_output(raw_orders,5)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-----+-----+---------+------+---------+-------------+
|key|value|topic|partition|offset|timestamp|timestampType|
+---+-----+-----+---------+------+---------+-------------+
+---+-----+-----+---------+------+---------+-------------+


>>> out.stop()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "latest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> out = console_output(raw_orders,5)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-----+-----+---------+------+---------+-------------+
|key|value|topic|partition|offset|timestamp|timestampType|
+---+-----+-----+---------+------+---------+-------------+
+---+-----+-----+---------+------+---------+-------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[5B]                                                                              |shadrin_iris|0        |3164  |2022-08-26 14:02:30.113|0            |
|null|[20 20 20 20 7B]                                                                  |shadrin_iris|0        |3165  |2022-08-26 14:02:30.118|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 31 2C]                                       |shadrin_iris|0        |3166  |2022-08-26 14:02:30.118|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2E 31 2C]|shadrin_iris|0        |3167  |2022-08-26 14:02:30.118|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 35 2C]   |shadrin_iris|0        |3168  |2022-08-26 14:02:30.118|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]         |shadrin_iris|0        |3169  |2022-08-26 14:02:30.118|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |3170  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |3171  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |3172  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |3173  |2022-08-26 14:02:30.119|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 32 2C]                                       |shadrin_iris|0        |3174  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 39 2C]|shadrin_iris|0        |3175  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2C]         |shadrin_iris|0        |3176  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]|shadrin_iris|0        |3177  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]   |shadrin_iris|0        |3178  |2022-08-26 14:02:30.119|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 4
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |3179  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |3180  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |3181  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 33 2C]                                                |shadrin_iris|0        |3182  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 37 2C]         |shadrin_iris|0        |3183  |2022-08-26 14:02:30.119|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 5
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 32 2C]            |shadrin_iris|0        |3184  |2022-08-26 14:02:30.119|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 33 2C]         |shadrin_iris|0        |3185  |2022-08-26 14:02:30.12 |0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |3186  |2022-08-26 14:02:30.12 |0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |3187  |2022-08-26 14:02:30.12 |0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |3188  |2022-08-26 14:02:30.12 |0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 6
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp             |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+----------------------+-------------+
|null|[20 20 20 20 7B]                                                                  |shadrin_iris|0        |3189  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 34 2C]                                       |shadrin_iris|0        |3190  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 36 2C]|shadrin_iris|0        |3191  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 31 2C]   |shadrin_iris|0        |3192  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 35 2C]|shadrin_iris|0        |3193  |2022-08-26 14:02:30.12|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+----------------------+-------------+

-------------------------------------------
Batch: 7
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp             |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+----------------------+-------------+
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |3194  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |3195  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |3196  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |3197  |2022-08-26 14:02:30.12|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 35 2C]                                                |shadrin_iris|0        |3198  |2022-08-26 14:02:30.12|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+----------------------+-------------+

out.stop()-------------------------------------------
Batch: 8
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2C]               |shadrin_iris|0        |3199  |2022-08-26 14:02:30.12 |0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 36 2C]            |shadrin_iris|0        |3200  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]         |shadrin_iris|0        |3201  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |3202  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |3203  |2022-08-26 14:02:30.121|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

out.stop()
  File "<stdin>", line 1
    out.stop()out.stop()
                ^
SyntaxError: invalid syntax
>>> -------------------------------------------
Batch: 9
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 7D 2C]                                                               |shadrin_iris|0        |3204  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 7B]                                                                  |shadrin_iris|0        |3205  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 36 2C]                                       |shadrin_iris|0        |3206  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2E 34 2C]|shadrin_iris|0        |3207  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 39 2C]   |shadrin_iris|0        |3208  |2022-08-26 14:02:30.121|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 10
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 37 2C]         |shadrin_iris|0        |3209  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 34 2C]            |shadrin_iris|0        |3210  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |3211  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |3212  |2022-08-26 14:02:30.121|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |3213  |2022-08-26 14:02:30.121|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

out.stop()
>>> out.stop()
>>> schema = StrucType() \
...     .add("Id",StringType()) \
...     .add("SepalLengthCm", StringType()) \
...     .add("SepalWidthCm", StringType()) \
...     .add("PetalLengthCm", StringType()) \
...     .add("PetalWidthCm", StringType()) \
...     .add("Species", StringType()) 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'StrucType' is not defined
>>> aw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "earliest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> schema = StructType() \
...     .add("Id",StringType()) \
...     .add("SepalLengthCm", StringType()) \
...     .add("SepalWidthCm", StringType()) \
...     .add("PetalLengthCm", StringType()) \
...     .add("PetalWidthCm", StringType()) \
...     .add("Species", StringType()) 
>>> value_orders = raw_orders \
...     .select(F.from_json(F.col("value").cast("String"), schema).alias("value", "offset")
... 
... 
Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> value_orders = raw_orders \
...     .select(F.from_json(F.col("value").cast("String"), schema).alias("value"), "offset")
>>> 
>>> 
Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> value_orders = raw_orders.select(F.from_json(F.col("value").cast("String"), schema).alias("value"), "offset")
>>> value_orders.printSchema()
root
 |-- value: struct (nullable = true)
 |    |-- Id: string (nullable = true)
 |    |-- SepalLengthCm: string (nullable = true)
 |    |-- SepalWidthCm: string (nullable = true)
 |    |-- PetalLengthCm: string (nullable = true)
 |    |-- PetalWidthCm: string (nullable = true)
 |    |-- Species: string (nullable = true)
 |-- offset: long (nullable = true)

>>> parsed_orders = value_orders.select("value.*", "offset")
>>> parsed_orders.printSchema()
root
 |-- Id: string (nullable = true)
 |-- SepalLengthCm: string (nullable = true)
 |-- SepalWidthCm: string (nullable = true)
 |-- PetalLengthCm: string (nullable = true)
 |-- PetalWidthCm: string (nullable = true)
 |-- Species: string (nullable = true)
 |-- offset: long (nullable = true)

>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |4366  |
|null|null         |null        |null         |null        |null   |4367  |
|null|null         |null        |null         |null        |null   |4368  |
|null|null         |null        |null         |null        |null   |4369  |
|null|null         |null        |null         |null        |null   |4370  |
+----+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |4371  |
|null|null         |null        |null         |null        |null   |4372  |
|null|null         |null        |null         |null        |null   |4373  |
|null|null         |null        |null         |null        |null   |4374  |
|null|null         |null        |null         |null        |null   |4375  |
+----+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> -------------------------------------------
Batch: 3
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |4376  |
|null|null         |null        |null         |null        |null   |4377  |
|null|null         |null        |null         |null        |null   |4378  |
|null|null         |null        |null         |null        |null   |4379  |
|null|null         |null        |null         |null        |null   |4380  |
+----+-------------+------------+-------------+------------+-------+------+

out.stop()
>>> out.stop()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "latest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> parsed_orders.printSchema()
root
 |-- Id: string (nullable = true)
 |-- SepalLengthCm: string (nullable = true)
 |-- SepalWidthCm: string (nullable = true)
 |-- PetalLengthCm: string (nullable = true)
 |-- PetalWidthCm: string (nullable = true)
 |-- Species: string (nullable = true)
 |-- offset: long (nullable = true)

>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |5566  |
|null|null         |null        |null         |null        |null   |5567  |
|null|null         |null        |null         |null        |null   |5568  |
|null|null         |null        |null         |null        |null   |5569  |
|null|null         |null        |null         |null        |null   |5570  |
+----+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |5571  |
|null|null         |null        |null         |null        |null   |5572  |
|null|null         |null        |null         |null        |null   |5573  |
|null|null         |null        |null         |null        |null   |5574  |
|null|null         |null        |null         |null        |null   |5575  |
+----+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> 
>>> schema = StructType() \
...     .add("Id",StringType()) \
...     .add("SepalLengthCm", StringType()) \
...     .add("SepalWidthCm", StringType()) \
...     .add("PetalLengthCm", StringType()) \
...     .add("PetalWidthCm", StringType()) \
...     .add("Species", StringType()) 
>>> value_orders = raw_orders.select(F.from_json(F.col("value").cast("String"), schema).alias("value"), "offset")
>>> parsed_orders = value_orders.select("value.*", "offset")
>>> parsed_orders.printSchema()
root
 |-- Id: string (nullable = true)
 |-- SepalLengthCm: string (nullable = true)
 |-- SepalWidthCm: string (nullable = true)
 |-- PetalLengthCm: string (nullable = true)
 |-- PetalWidthCm: string (nullable = true)
 |-- Species: string (nullable = true)
 |-- offset: long (nullable = true)

>>> raw_orders =  spark.readStream\
... ...         .format("kafka") \
  File "<stdin>", line 2
    ...         .format("kafka") \
     ^
SyntaxError: invalid syntax
>>> ...         .option("kafka.bootstrap.servers", kafka_brokers)\
  File "<stdin>", line 1
    ...         .option("kafka.bootstrap.servers", kafka_brokers)\
    ^
SyntaxError: invalid syntax
>>> ...         .option("subscribe", "shadrin_iris")\
  File "<stdin>", line 1
    ...         .option("subscribe", "shadrin_iris")\
    ^
SyntaxError: invalid syntax
>>> ...         .option("startingOffests", "earliest")\
  File "<stdin>", line 1
    ...         .option("startingOffests", "earliest")\
    ^
SyntaxError: invalid syntax
>>> ...         .option("maxOffsetsPerTrigger", "5")\
  File "<stdin>", line 1
    ...         .option("maxOffsetsPerTrigger", "5")\
    ^
SyntaxError: invalid syntax
>>> ...         .load()
  File "<stdin>", line 1
    ...         .load()
    ^
SyntaxError: invalid syntax
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "earliest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |6766  |
|null|null         |null        |null         |null        |null   |6767  |
|null|null         |null        |null         |null        |null   |6768  |
|null|null         |null        |null         |null        |null   |6769  |
|null|null         |null        |null         |null        |null   |6770  |
+----+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "timofeeva_iris")\
...         .option("startingOffests", "earliest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "timofeeva_iris")\
...         .option("startingOffests", "earliest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> schema = StructType() \
...     .add("Id",StringType()) \
...     .add("SepalLengthCm", StringType()) \
...     .add("SepalWidthCm", StringType()) \
...     .add("PetalLengthCm", StringType()) \
...     .add("PetalWidthCm", StringType()) \
...     .add("Species", StringType()) 
>>> value_orders = raw_orders.select(F.from_json(F.col("value").cast("String"), schema).alias("value"), "offset")
>>> parsed_orders = value_orders.select("value.*", "offset")
>>> parsed_orders.printSchema()
root
 |-- Id: string (nullable = true)
 |-- SepalLengthCm: string (nullable = true)
 |-- SepalWidthCm: string (nullable = true)
 |-- PetalLengthCm: string (nullable = true)
 |-- PetalWidthCm: string (nullable = true)
 |-- Species: string (nullable = true)
 |-- offset: long (nullable = true)

>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |3600  |
|null|null         |null        |null         |null        |null   |3601  |
|null|null         |null        |null         |null        |null   |3602  |
|null|null         |null        |null         |null        |null   |3603  |
|null|null         |null        |null         |null        |null   |3604  |
+----+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |3605  |
|null|null         |null        |null         |null        |null   |3606  |
|null|null         |null        |null         |null        |null   |3607  |
|null|null         |null        |null         |null        |null   |3608  |
|null|null         |null        |null         |null        |null   |3609  |
+----+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 3
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |3610  |
|null|null         |null        |null         |null        |null   |3611  |
|null|null         |null        |null         |null        |null   |3612  |
|null|null         |null        |null         |null        |null   |3613  |
|null|null         |null        |null         |null        |null   |3614  |
+----+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> raw_orders =  spark.readStream\-------------------------------------------
Batch: 4
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |3615  |
|null|null         |null        |null         |null        |null   |3616  |
|null|null         |null        |null         |null        |null   |3617  |
|null|null         |null        |null         |null        |null   |3618  |
|null|null         |null        |null         |null        |null   |3619  |
+----+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> raw_orders =  spark.readStream\
...         .format("kafka") \
...         .option("kafka.bootstrap.servers", kafka_brokers)\
...         .option("subscribe", "shadrin_iris")\
...         .option("startingOffests", "latest")\
...         .option("maxOffsetsPerTrigger", "5")\
...         .load()
>>> out = console_output(raw_orders,5)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-----+-----+---------+------+---------+-------------+
|key|value|topic|partition|offset|timestamp|timestampType|
+---+-----+-----+---------+------+---------+-------------+
+---+-----+-----+---------+------+---------+-------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[5B]                                                                              |shadrin_iris|0        |7966  |2022-08-26 15:00:04.557|0            |
|null|[20 20 20 20 7B]                                                                  |shadrin_iris|0        |7967  |2022-08-26 15:00:04.564|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 31 2C]                                       |shadrin_iris|0        |7968  |2022-08-26 15:00:04.564|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 35 2E 31 2C]|shadrin_iris|0        |7969  |2022-08-26 15:00:04.564|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 35 2C]   |shadrin_iris|0        |7970  |2022-08-26 15:00:04.565|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]         |shadrin_iris|0        |7971  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |7972  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |7973  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |7974  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |7975  |2022-08-26 15:00:04.565|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                             |topic       |partition|offset|timestamp              |timestampType|
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 32 2C]                                       |shadrin_iris|0        |7976  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 39 2C]|shadrin_iris|0        |7977  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2C]         |shadrin_iris|0        |7978  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 34 2C]|shadrin_iris|0        |7979  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]   |shadrin_iris|0        |7980  |2022-08-26 15:00:04.565|0            |
+----+----------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> -------------------------------------------
Batch: 4
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |7981  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |7982  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 7B]                                                                           |shadrin_iris|0        |7983  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 49 64 22 3A 20 33 2C]                                                |shadrin_iris|0        |7984  |2022-08-26 15:00:04.565|0            |
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 34 2E 37 2C]         |shadrin_iris|0        |7985  |2022-08-26 15:00:04.566|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+

-------------------------------------------
Batch: 5
-------------------------------------------
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|key |value                                                                                      |topic       |partition|offset|timestamp              |timestampType|
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+
|null|[20 20 20 20 20 20 22 53 65 70 61 6C 57 69 64 74 68 43 6D 22 3A 20 33 2E 32 2C]            |shadrin_iris|0        |7986  |2022-08-26 15:00:04.566|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 4C 65 6E 67 74 68 43 6D 22 3A 20 31 2E 33 2C]         |shadrin_iris|0        |7987  |2022-08-26 15:00:04.566|0            |
|null|[20 20 20 20 20 20 22 50 65 74 61 6C 57 69 64 74 68 43 6D 22 3A 20 30 2E 32 2C]            |shadrin_iris|0        |7988  |2022-08-26 15:00:04.566|0            |
|null|[20 20 20 20 20 20 22 53 70 65 63 69 65 73 22 3A 20 22 49 72 69 73 2D 73 65 74 6F 73 61 22]|shadrin_iris|0        |7989  |2022-08-26 15:00:04.566|0            |
|null|[20 20 20 20 7D 2C]                                                                        |shadrin_iris|0        |7990  |2022-08-26 15:00:04.566|0            |
+----+-------------------------------------------------------------------------------------------+------------+---------+------+-----------------------+-------------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> value_orders = raw_orders.select(F.from_json(F.col("value").cast("String"), schema).alias("value"), "offset")
>>> value_orders.printSchema()
root
 |-- value: struct (nullable = true)
 |    |-- Id: string (nullable = true)
 |    |-- SepalLengthCm: string (nullable = true)
 |    |-- SepalWidthCm: string (nullable = true)
 |    |-- PetalLengthCm: string (nullable = true)
 |    |-- PetalWidthCm: string (nullable = true)
 |    |-- Species: string (nullable = true)
 |-- offset: long (nullable = true)

>>> out = console_output(value_orders,5)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+-----+------+
|value|offset|
+-----+------+
+-----+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+-----+------+
|value|offset|
+-----+------+
|null |9166  |
|null |9167  |
|null |9168  |
|null |9169  |
|null |9170  |
+-----+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+-----+------+
|value|offset|
+-----+------+
|null |9171  |
|null |9172  |
|null |9173  |
|null |9174  |
|null |9175  |
+-----+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> -------------------------------------------
Batch: 3
-------------------------------------------
+-----+------+
|value|offset|
+-----+------+
|null |9176  |
|null |9177  |
|null |9178  |
|null |9179  |
|null |9180  |
+-----+------+

out.stop()-------------------------------------------
Batch: 4
-------------------------------------------
+-----+------+
|value|offset|
+-----+------+
|null |9181  |
|null |9182  |
|null |9183  |
|null |9184  |
|null |9185  |
+-----+------+


>>> out.stop()
>>> parsed_orders = value_orders.select("value.*", "offset")
>>> parsed_orders.printSchema()
root
 |-- Id: string (nullable = true)
 |-- SepalLengthCm: string (nullable = true)
 |-- SepalWidthCm: string (nullable = true)
 |-- PetalLengthCm: string (nullable = true)
 |-- PetalWidthCm: string (nullable = true)
 |-- Species: string (nullable = true)
 |-- offset: long (nullable = true)

>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |10366 |
|null|null         |null        |null         |null        |null   |10367 |
|null|null         |null        |null         |null        |null   |10368 |
|null|null         |null        |null         |null        |null   |10369 |
|null|null         |null        |null         |null        |null   |10370 |
+----+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |11566 |
|null|null         |null        |null         |null        |null   |11567 |
|null|null         |null        |null         |null        |null   |11568 |
|null|null         |null        |null         |null        |null   |11569 |
|null|null         |null        |null         |null        |null   |11570 |
+----+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-------------+------------+-------------+------------+-------+------+
|Id  |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+----+-------------+------------+-------------+------------+-------+------+
|null|null         |null        |null         |null        |null   |11571 |
|null|null         |null        |null         |null        |null   |11572 |
|null|null         |null        |null         |null        |null   |11573 |
|null|null         |null        |null         |null        |null   |11574 |
|null|null         |null        |null         |null        |null   |11575 |
+----+-------------+------------+-------------+------------+-------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()

>>> out = console_output(parsed_orders,15)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |13966 |
|1  |5.1          |3.5         |1.4          |0.2         |Iris-setosa|13967 |
|2  |4.9          |3.0         |1.4          |0.2         |Iris-setosa|13968 |
|3  |4.7          |3.2         |1.3          |0.2         |Iris-setosa|13969 |
|4  |4.6          |3.1         |1.5          |0.2         |Iris-setosa|13970 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|5  |5.0          |3.6         |1.4          |0.2         |Iris-setosa|13971 |
|6  |5.4          |3.9         |1.7          |0.4         |Iris-setosa|13972 |
|7  |4.6          |3.4         |1.4          |0.3         |Iris-setosa|13973 |
|8  |5.0          |3.4         |1.5          |0.2         |Iris-setosa|13974 |
|9  |4.4          |2.9         |1.4          |0.2         |Iris-setosa|13975 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 3
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|10 |4.9          |3.1         |1.5          |0.1         |Iris-setosa|13976 |
|11 |5.4          |3.7         |1.5          |0.2         |Iris-setosa|13977 |
|12 |4.8          |3.4         |1.6          |0.2         |Iris-setosa|13978 |
|13 |4.8          |3.0         |1.4          |0.1         |Iris-setosa|13979 |
|14 |4.3          |3.0         |1.1          |0.1         |Iris-setosa|13980 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 4
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|15 |5.8          |4.0         |1.2          |0.2         |Iris-setosa|13981 |
|16 |5.7          |4.4         |1.5          |0.4         |Iris-setosa|13982 |
|17 |5.4          |3.9         |1.3          |0.4         |Iris-setosa|13983 |
|18 |5.1          |3.5         |1.4          |0.3         |Iris-setosa|13984 |
|19 |5.7          |3.8         |1.7          |0.3         |Iris-setosa|13985 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 5
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|20 |5.1          |3.8         |1.5          |0.3         |Iris-setosa|13986 |
|21 |5.4          |3.4         |1.7          |0.2         |Iris-setosa|13987 |
|22 |5.1          |3.7         |1.5          |0.4         |Iris-setosa|13988 |
|23 |4.6          |3.6         |1.0          |0.2         |Iris-setosa|13989 |
|24 |5.1          |3.3         |1.7          |0.5         |Iris-setosa|13990 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 6
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|25 |4.8          |3.4         |1.9          |0.2         |Iris-setosa|13991 |
|26 |5.0          |3.0         |1.6          |0.2         |Iris-setosa|13992 |
|27 |5.0          |3.4         |1.6          |0.4         |Iris-setosa|13993 |
|28 |5.2          |3.5         |1.5          |0.2         |Iris-setosa|13994 |
|29 |5.2          |3.4         |1.4          |0.2         |Iris-setosa|13995 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 7
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|30 |4.7          |3.2         |1.6          |0.2         |Iris-setosa|13996 |
|31 |4.8          |3.1         |1.6          |0.2         |Iris-setosa|13997 |
|32 |5.4          |3.4         |1.5          |0.4         |Iris-setosa|13998 |
|33 |5.2          |4.1         |1.5          |0.1         |Iris-setosa|13999 |
|34 |5.5          |4.2         |1.4          |0.2         |Iris-setosa|14000 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 8
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|35 |4.9          |3.1         |1.5          |0.1         |Iris-setosa|14001 |
|36 |5.0          |3.2         |1.2          |0.2         |Iris-setosa|14002 |
|37 |5.5          |3.5         |1.3          |0.2         |Iris-setosa|14003 |
|38 |4.9          |3.1         |1.5          |0.1         |Iris-setosa|14004 |
|39 |4.4          |3.0         |1.3          |0.2         |Iris-setosa|14005 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 9
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|40 |5.1          |3.4         |1.5          |0.2         |Iris-setosa|14006 |
|41 |5.0          |3.5         |1.3          |0.3         |Iris-setosa|14007 |
|42 |4.5          |2.3         |1.3          |0.3         |Iris-setosa|14008 |
|43 |4.4          |3.2         |1.3          |0.2         |Iris-setosa|14009 |
|44 |5.0          |3.5         |1.6          |0.6         |Iris-setosa|14010 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 10
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|45 |5.1          |3.8         |1.9          |0.4         |Iris-setosa|14011 |
|46 |4.8          |3.0         |1.4          |0.3         |Iris-setosa|14012 |
|47 |5.1          |3.8         |1.6          |0.2         |Iris-setosa|14013 |
|48 |4.6          |3.2         |1.4          |0.2         |Iris-setosa|14014 |
|49 |5.3          |3.7         |1.5          |0.2         |Iris-setosa|14015 |
+---+-------------+------------+-------------+------------+-----------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> def console_output_checkpointed(df, freq):
...     return df.writeStream \
...         .format("console") \
...         .trigger(processingTime='%s seconds' % freq) \
...         .option("truncate",False) \
...         .option("checkpointLocation", "timofeeva_iris_console_checkpoint") \
...         .start()
... 
>>> out = console_output_checkpointed(parsed_iris, 5)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'parsed_iris' is not defined
>>> out = console_output_checkpointed(parsed_orders, 5)
>>> -------------------------------------------
Batch: 0
-------------------------------------------
+---+-------------+------------+-------------+------------+-------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species|offset|
+---+-------------+------------+-------------+------------+-------+------+
+---+-------------+------------+-------------+------------+-------+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|1  |5.1          |3.5         |1.4          |0.2         |Iris-setosa|14117 |
|2  |4.9          |3.0         |1.4          |0.2         |Iris-setosa|14118 |
|3  |4.7          |3.2         |1.3          |0.2         |Iris-setosa|14119 |
|4  |4.6          |3.1         |1.5          |0.2         |Iris-setosa|14120 |
|5  |5.0          |3.6         |1.4          |0.2         |Iris-setosa|14121 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|6  |5.4          |3.9         |1.7          |0.4         |Iris-setosa|14122 |
|7  |4.6          |3.4         |1.4          |0.3         |Iris-setosa|14123 |
|8  |5.0          |3.4         |1.5          |0.2         |Iris-setosa|14124 |
|9  |4.4          |2.9         |1.4          |0.2         |Iris-setosa|14125 |
|10 |4.9          |3.1         |1.5          |0.1         |Iris-setosa|14126 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 3
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|11 |5.4          |3.7         |1.5          |0.2         |Iris-setosa|14127 |
|12 |4.8          |3.4         |1.6          |0.2         |Iris-setosa|14128 |
|13 |4.8          |3.0         |1.4          |0.1         |Iris-setosa|14129 |
|14 |4.3          |3.0         |1.1          |0.1         |Iris-setosa|14130 |
|15 |5.8          |4.0         |1.2          |0.2         |Iris-setosa|14131 |
+---+-------------+------------+-------------+------------+-----------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()-------------------------------------------
Batch: 4
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|16 |5.7          |4.4         |1.5          |0.4         |Iris-setosa|14132 |
|17 |5.4          |3.9         |1.3          |0.4         |Iris-setosa|14133 |
|18 |5.1          |3.5         |1.4          |0.3         |Iris-setosa|14134 |
|19 |5.7          |3.8         |1.7          |0.3         |Iris-setosa|14135 |
|20 |5.1          |3.8         |1.5          |0.3         |Iris-setosa|14136 |
+---+-------------+------------+-------------+------------+-----------+------+


>>> out.stop()
>>> out = console_output_checkpointed(parsed_orders, 5)
>>> -------------------------------------------
Batch: 5
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|21 |5.4          |3.4         |1.7          |0.2         |Iris-setosa|14137 |
|22 |5.1          |3.7         |1.5          |0.4         |Iris-setosa|14138 |
|23 |4.6          |3.6         |1.0          |0.2         |Iris-setosa|14139 |
|24 |5.1          |3.3         |1.7          |0.5         |Iris-setosa|14140 |
|25 |4.8          |3.4         |1.9          |0.2         |Iris-setosa|14141 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 6
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|26 |5.0          |3.0         |1.6          |0.2         |Iris-setosa|14142 |
|27 |5.0          |3.4         |1.6          |0.4         |Iris-setosa|14143 |
|28 |5.2          |3.5         |1.5          |0.2         |Iris-setosa|14144 |
|29 |5.2          |3.4         |1.4          |0.2         |Iris-setosa|14145 |
|30 |4.7          |3.2         |1.6          |0.2         |Iris-setosa|14146 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 7
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|31 |4.8          |3.1         |1.6          |0.2         |Iris-setosa|14147 |
|32 |5.4          |3.4         |1.5          |0.4         |Iris-setosa|14148 |
|33 |5.2          |4.1         |1.5          |0.1         |Iris-setosa|14149 |
|34 |5.5          |4.2         |1.4          |0.2         |Iris-setosa|14150 |
|35 |4.9          |3.1         |1.5          |0.1         |Iris-setosa|14151 |
+---+-------------+------------+-------------+------------+-----------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> def console_output_checkpointed(df, freq):
...     return df.writeStream \
...         .format("console") \
...         .trigger(processingTime='%s seconds' % freq) \
...         .option("truncate",False) \
...         .option("checkpointLocation", "timofeeva_iris_console_checkpoint") \
...         .start()
... 
>>> out = console_output_checkpointed(parsed_orders, 5)
>>> -------------------------------------------
Batch: 8
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|36 |5.0          |3.2         |1.2          |0.2         |Iris-setosa|14152 |
|37 |5.5          |3.5         |1.3          |0.2         |Iris-setosa|14153 |
|38 |4.9          |3.1         |1.5          |0.1         |Iris-setosa|14154 |
|39 |4.4          |3.0         |1.3          |0.2         |Iris-setosa|14155 |
|40 |5.1          |3.4         |1.5          |0.2         |Iris-setosa|14156 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 9
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|41 |5.0          |3.5         |1.3          |0.3         |Iris-setosa|14157 |
|42 |4.5          |2.3         |1.3          |0.3         |Iris-setosa|14158 |
|43 |4.4          |3.2         |1.3          |0.2         |Iris-setosa|14159 |
|44 |5.0          |3.5         |1.6          |0.6         |Iris-setosa|14160 |
|45 |5.1          |3.8         |1.9          |0.4         |Iris-setosa|14161 |
+---+-------------+------------+-------------+------------+-----------+------+

-------------------------------------------
Batch: 10
-------------------------------------------
+---+-------------+------------+-------------+------------+-----------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species    |offset|
+---+-------------+------------+-------------+------------+-----------+------+
|46 |4.8          |3.0         |1.4          |0.3         |Iris-setosa|14162 |
|47 |5.1          |3.8         |1.6          |0.2         |Iris-setosa|14163 |
|48 |4.6          |3.2         |1.4          |0.2         |Iris-setosa|14164 |
|49 |5.3          |3.7         |1.5          |0.2         |Iris-setosa|14165 |
|50 |5.0          |3.3         |1.4          |0.2         |Iris-setosa|14166 |
+---+-------------+------------+-------------+------------+-----------+------+

out -------------------------------------------
Batch: 11
-------------------------------------------
+---+-------------+------------+-------------+------------+---------------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species        |offset|
+---+-------------+------------+-------------+------------+---------------+------+
|51 |7.0          |3.2         |4.7          |1.4         |Iris-versicolor|14167 |
|52 |6.4          |3.2         |4.5          |1.5         |Iris-versicolor|14168 |
|53 |6.9          |3.1         |4.9          |1.5         |Iris-versicolor|14169 |
|54 |5.5          |2.3         |4.0          |1.3         |Iris-versicolor|14170 |
|55 |6.5          |2.8         |4.6          |1.5         |Iris-versicolor|14171 |
+---+-------------+------------+-------------+------------+---------------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> out = console_output_checkpointed(parsed_orders, 5)
>>> -------------------------------------------
Batch: 12
-------------------------------------------
+---+-------------+------------+-------------+------------+---------------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species        |offset|
+---+-------------+------------+-------------+------------+---------------+------+
|56 |5.7          |2.8         |4.5          |1.3         |Iris-versicolor|14172 |
|57 |6.3          |3.3         |4.7          |1.6         |Iris-versicolor|14173 |
|58 |4.9          |2.4         |3.3          |1.0         |Iris-versicolor|14174 |
|59 |6.6          |2.9         |4.6          |1.3         |Iris-versicolor|14175 |
|60 |5.2          |2.7         |3.9          |1.4         |Iris-versicolor|14176 |
+---+-------------+------------+-------------+------------+---------------+------+

-------------------------------------------
Batch: 13
-------------------------------------------
+---+-------------+------------+-------------+------------+---------------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species        |offset|
+---+-------------+------------+-------------+------------+---------------+------+
|61 |5.0          |2.0         |3.5          |1.0         |Iris-versicolor|14177 |
|62 |5.9          |3.0         |4.2          |1.5         |Iris-versicolor|14178 |
|63 |6.0          |2.2         |4.0          |1.0         |Iris-versicolor|14179 |
|64 |6.1          |2.9         |4.7          |1.4         |Iris-versicolor|14180 |
|65 |5.6          |2.9         |3.6          |1.3         |Iris-versicolor|14181 |
+---+-------------+------------+-------------+------------+---------------+------+

-------------------------------------------
Batch: 14
-------------------------------------------
+---+-------------+------------+-------------+------------+---------------+------+
|Id |SepalLengthCm|SepalWidthCm|PetalLengthCm|PetalWidthCm|Species        |offset|
+---+-------------+------------+-------------+------------+---------------+------+
|66 |6.7          |3.1         |4.4          |1.4         |Iris-versicolor|14182 |
|67 |5.6          |3.0         |4.5          |1.5         |Iris-versicolor|14183 |
|68 |5.8          |2.7         |4.1          |1.0         |Iris-versicolor|14184 |
|69 |6.2          |2.2         |4.5          |1.5         |Iris-versicolor|14185 |
|70 |5.6          |2.5         |3.9          |1.1         |Iris-versicolor|14186 |
+---+-------------+------------+-------------+------------+---------------+------+


Traceback (most recent call last):
  File "/usr/hdp/current/spark2-client/python/pyspark/context.py", line 261, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt
>>> out.stop()
>>> 
